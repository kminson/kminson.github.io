---
title: "The Monty Hall Problem"
bibliography: references.bib
author: "Minsong Kim"
subtitle: "12/05/2005"
format:
  revealjs:
    scrollable: true
    slide-number: true
    show-slide-number: all
    embed-resources: true
execute:
  echo: true
  warning: false
  message: false
---

## What is the Monty Hall problem?

-   A probability puzzle

-   Based on a game from the TV Show, *Let's Make a Deal*, and named after the host, Monty Hall

    [@noauthor_1975-jo]

-   Made famous in the "Ask Marilyn" column in the *Parade* magazine in 1990, where readers ask about various puzzles and problems to Marilyn vos Savant, a genius columnist who has the highest recorded IQ in history.

    [@savant1990] [@knight2009]

[Main Menu](https://kminson.github.io)

## The Problem Setup

Suppose you're on a game show, and you're given the choice of three doors: Behind one door is a car; behind the others, goats. You pick a door, say No. 1, and the host, who knows what's behind the doors, opens another door, say No. 3, which has a goat. He then says to you, "Do you want to pick door No. 2?" Is it to your advantage to switch your choice?

[@savant1990]

## The Dispute

-   Marilyn first wrote "Yes; you should switch. The first door has a 1/3 chance of winning, but the second door has a 2/3 chance..."

-   Many readers disagreed and disputed this, with Marilyn receiving letters from all over the country, many of whom had PhD's.

-   "You blew it, and you blew it big! ...There is enough mathematical illiteracy in this country, and we don’t need the world’s highest IQ propagating more. Shame!"

    **-*Scott Smith, Ph.D, University of Florida***

-   "...You blew it! ...As a professional mathematician, I’m very concerned with the general public’s lack of mathematical skills. Please help by confessing your error and in the future being more careful."

    **-*Robert Sachs, Ph.D, George Mason University***

-   "You are utterly incorrect about the game show question, and I hope this controversy will call some public attention to the serious national crisis in mathematical education. If you can admit your error, you will have contributed constructively towards the solution of a deplorable situation. How many irate mathematicians are needed to get you to change your mind?"

    **-*E. Ray Bobo, Ph.D, Georgetown University***

-   "May I suggest that you obtain and refer to a standard textbook on probability before you try to answer a question of this type again?"

    **-*Charles Reid, Ph.D, University of Florida***

-   "Maybe women look at math problems differently than men."

    **-*Don Edwards, Sunriver, Oregon***

    [@savant1990]

## The Simulation Function

```{r}
#| message: false
monty_hall <- function(switch_choice) {
  doors <- letters[1:3] #A character vector of a, b, c to 
  #represent the three doors; a is the prize door
  first_choice <- sample(doors, 1) #Randomly choose our first door
  
  
  reveal <- if (first_choice == "a") { #Randomly reveal either b 
    #or c if a is selected
    sample(doors[doors != "a"], 1)
  } else if (first_choice == "b") { #Otherwise, reveal the 
    #unselected non-prize door
    "c"
  } else {
    "b"
  }
  
  doors <- doors[doors != reveal] #Reveal the selected door
  
  second_choice = if (switch_choice == 1) { 
    second_choice = sample(doors[doors != first_choice], 1) #If 
    #switch = 1, we switch to the other door
  } else {
    second_choice = first_choice #Otherwise, we stay with our 
    #first door
  }

  result = ifelse(second_choice == "a", #If our second choice is a,
                  # we win!
                         "Success!",
                         "Dud..."
                  )
  data.frame(second_choice, result) #Create a dataframe with a 
  #column showing final selected door and results
}
```

## The Simulation

```{r}
#| message: false
library(tidyverse)
n <- 10000 #Set the simulation count to 10,000
switch_result <- 1:n |> #Use mapping to simulate the function n 
  #times with switching
  map(~ monty_hall(1)) |>
  list_rbind()

switch_summary <- switch_result |> #Condense the table of results 
  #to proportion of successes and failures
  group_by(result) |>
  summarise(number = n()) |>
  mutate(proportion = number / sum(number))

noswitch_result <- 1:n |> #Repeat for no switching
  map(~ monty_hall(0)) |>
  list_rbind()

noswitch_summary <- noswitch_result |>
  group_by(result) |>
  summarise(number2 = n()) |>
  mutate(proportion2 = number2 / sum(number2))
```

## Results

```{r}
#| message: false
full_summary <- full_join(switch_summary, noswitch_summary, by = "result") #Join the proportion results into one table

plot_data <- full_summary |> #Create a new table for easier 
  #plotting
  select(result, proportion, proportion2) |>
  pivot_longer(cols = starts_with("proportion"),
               names_to = "strategy",
               values_to = "proportion") |>
  mutate(strategy = if_else(strategy == "proportion", "Switch", "No Switch")) |>
  mutate(result = fct_relevel(result, c("Success!", "Dud..."))) |>
  mutate(strategy = fct_relevel(strategy, c("Switch", "No Switch")))
full_summary
plot_data
```

## Results cont.

```{r}
ggplot(plot_data, aes(x = result, y = proportion, fill = strategy)) + #Plot!
  geom_col(position = "dodge") +
  labs(
    title = "Monty Hall Simulation Results of 100,000 Runs",
    x = "Outcome",
    y = "Proportion of Wins",
    fill = "Strategy"
  ) +
  theme_minimal()
```

## Conclusion

"Of the general public, about 56% now believe you should switch compared with only 8% before. And from academic institutions, about 71% now believe you should switch compared with only 35% before....And so we’ve made progress! Half of the readers whose letters were published in the previous columns have written to say they’ve changed their minds..."

\- **Marilyn vos Savant**

"I still think you’re wrong. There is such a thing as female logic."\
- ***Don Edwards, Sunriver, Oregon***

"Oh hush, now."

\- **Marilyn vos Savant**

## References

::: {#refs}
:::

[Main Menu](https://kminson.github.io)
